<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <link rel="manifest" href="manifest.json">
    <title>WordZen Arena</title>
    <style>
        :root { --neon-green: #00ff88; --neon-red: #ff3e3e; --neon-gold: #ffd700; --neon-blue: #00d4ff; --neon-purple: #a855f7; }
        body { 
            margin: 0; background: #000; color: white; overflow: hidden;
            font-family: 'Segoe UI', Roboto, sans-serif; display: flex; flex-direction: column; align-items: center; 
            height: 100vh; width: 100%; position: fixed;
        }

        /* SPLASH ANÄ°MASYONU */
        #splash { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .s-logo { font-size: 3rem; font-weight: 200; color: #fff; letter-spacing: 15px; animation: zenFade 4s forwards; }
        @keyframes zenFade { 0% { opacity: 0; transform: scale(0.8); } 50% { opacity: 1; } 100% { opacity: 0; transform: scale(1.1); } }

        /* EKRANLAR */
        #name-screen, #main-menu, #arena-lobby, #game-screen { 
            position: fixed; inset: 0; background: #000; z-index: 1000; 
            display: none; flex-direction: column; align-items: center; justify-content: center; gap: 20px; 
        }

        .menu-btn { width: 260px; padding: 18px; border-radius: 15px; font-weight: bold; cursor: pointer; text-align: center; border: 2px solid transparent; background: rgba(255,255,255,0.03); color: white; transition: 0.3s; }
        #btn-normal { border-color: var(--neon-green); color: var(--neon-green); }
        #btn-arena { border-color: var(--neon-blue); color: var(--neon-blue); }

        /* OYUN ARAÃ‡LARI */
        #word-container { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; padding: 0 10px; }
        .letter-box { width: 38px; height: 52px; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; font-weight: bold; }
        .active-box { border-color: var(--neon-green); box-shadow: 0 0 10px var(--neon-green); }
        .correct-neon { border-color: var(--neon-green) !important; color: var(--neon-green); box-shadow: 0 0 15px var(--neon-green); }
        
        #timer-neon { font-size: 2.5rem; color: var(--neon-red); text-shadow: 0 0 15px var(--neon-red); font-weight: bold; margin-bottom: 10px; }
        #coin-display { position: absolute; top: 20px; right: 20px; color: var(--neon-gold); font-weight: bold; font-size: 1.2rem; z-index: 1500; }
        #meaning-box { margin-top: 20px; width: 85%; padding: 15px; border-radius: 15px; border: 1px solid var(--neon-purple); background: rgba(168, 85, 247, 0.1); display: none; text-align: center; }

        /* YARDIMCI BUTONLAR */
        #helper-container { position: fixed; bottom: 30px; right: 20px; display: none; flex-direction: column; gap: 15px; }
        .helper-btn { width: 65px; height: 65px; border-radius: 50%; background: #111; border: 1px solid var(--neon-gold); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; }
        .helper-label { font-size: 0.5rem; color: #fff; text-align: center; margin-top: 2px; }

        #offline-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 10000; display: none; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body onclick="focusInput()">

<div id="splash"><div class="s-logo">WordZen</div></div>
<div id="coin-display">ðŸª™ <span id="user-coins">0</span></div>

<div id="name-screen">
    <h2 style="color:var(--neon-blue)">KOD ADINIZ</h2>
    <input type="text" id="user-name-input" placeholder="Ä°sim..." maxlength="12" style="background:transparent; border:none; border-bottom:2px solid var(--neon-blue); color:white; font-size:1.5rem; text-align:center; outline:none;">
    <button class="menu-btn" style="border-color:var(--neon-green); margin-top:20px;" onclick="saveName()">BAÅžLA</button>
</div>

<div id="main-menu">
    <div style="font-size:2.5rem; color:var(--neon-blue); margin-bottom:40px; letter-spacing:10px;">WordZen</div>
    <div class="menu-btn" id="btn-normal" onclick="startNormal()">NORMAL MOD</div>
    <div class="menu-btn" id="btn-arena" onclick="openArena()">1v1 ARENA</div>
</div>

<div id="arena-lobby">
    <div style="border:1px solid var(--neon-blue); padding:30px; border-radius:20px; text-align:center; width:80%;">
        <h2 style="color:var(--neon-blue)">ARENA LOBÄ°SÄ°</h2>
        <div id="lobby-controls">
            <button class="menu-btn" style="border-color:var(--neon-gold); margin-bottom:10px;" onclick="createRoom()">ODA KUR</button>
            <p>veya</p>
            <input type="number" id="room-id-input" placeholder="ODA NO" style="background:transparent; border:none; border-bottom:1px solid #fff; color:#fff; font-size:1.5rem; width:120px; text-align:center; margin-bottom:20px;">
            <button class="menu-btn" style="border-color:var(--neon-blue);" onclick="joinRoom()">ODAYA KATIL</button>
        </div>
        <div id="room-active" style="display:none;">
            <h1 id="code-display" style="font-size:3rem; margin:10px 0;">----</h1>
            <p id="room-status" style="color:var(--neon-green);">Rakip bekleniyor... (1/2)</p>
            <button class="menu-btn" style="background:var(--neon-red); border:none;" onclick="startArenaMatch()">SAVAÅžI BAÅžLAT!</button>
        </div>
        <button onclick="exitLobby()" style="margin-top:20px; background:none; border:none; color:#555; text-decoration:underline;">KAPAT / Ã‡IK</button>
    </div>
</div>

<div id="game-screen">
    <div id="timer-neon">60</div>
    <div id="arena-scores" style="display:none; gap:30px; margin-bottom:10px; font-weight:bold;">
        <div style="color:var(--neon-blue)">SEN: <span id="p1-score">0</span></div>
        <div style="color:var(--neon-red)">RAKÄ°P: <span id="p2-score">0</span></div>
    </div>
    <div id="word-container"></div>
    <div id="meaning-box"><div style="color:var(--neon-purple); font-size:0.7rem; font-weight:bold; margin-bottom:5px;">ANLAMI</div><div id="m-text"></div></div>
    <button id="next-btn" onclick="nextLevel()" style="display:none; margin-top:20px; padding:12px 40px; background:var(--neon-green); border:none; border-radius:30px; font-weight:bold; color:black;">SONRAKÄ° (+25 ðŸª™)</button>
</div>

<div id="helper-container">
    <div class="helper-btn" onclick="getHint()" style="border-color:var(--neon-gold);">
        <span>ðŸ’¡</span><span class="helper-label">Ä°PUCU</span>
    </div>
    <div class="helper-btn" onclick="skipLevel()" style="border-color:var(--neon-blue);">
        <span>â‰«</span><span class="helper-label">25 ðŸª™<br>ATLA</span>
    </div>
</div>

<div id="offline-overlay">
    <div style="font-size:4rem;">ðŸ“¶<span style="color:var(--neon-red); font-weight:bold;">!</span></div>
    <h2 style="color:var(--neon-red)">BAÄžLANTINIZ KESÄ°LDÄ°</h2>
</div>

<input type="text" id="hidden-input" style="position:absolute; opacity:0; pointer-events:none;" autocomplete="off">

<script>
    const wordList = [
        {a:"ADA", m:"DÃ¶rt tarafÄ± sularla Ã§evrili kara parÃ§asÄ±.", h:[0]},
        {a:"BARDAK", m:"Ä°Ã§ecek iÃ§mek iÃ§in kullanÄ±lan kap.", h:[1,3]},
        {a:"LÃœGAT", m:"SÃ¶zlÃ¼k anlamÄ±ndaki eski kelime.", h:[0,2]},
        {a:"KALEM", m:"YazÄ± yazmaya yarayan araÃ§.", h:[1]},
        {a:"GÃœNEÅž", m:"Sistemimizin merkezindeki yÄ±ldÄ±z.", h:[0,4]}
        // Kanka 100 kelime buraya eklenecek
    ];

    let currentLvl = parseInt(localStorage.getItem('wz_lvl')) || 0;
    let coins = parseInt(localStorage.getItem('wz_coins')) || 0;
    let userName = localStorage.getItem('wz_name') || "";
    let userGuess = [];
    let isArena = false;
    let arenaRound = 1;
    let timer;

    window.onload = () => {
        updateCoinUI();
        setTimeout(() => {
            document.getElementById('splash').style.display = 'none';
            if(!userName) document.getElementById('name-screen').style.display = 'flex';
            else showMainMenu();
        }, 4000);
    };

    function saveName() {
        let name = document.getElementById('user-name-input').value.toUpperCase();
        if(name.length > 1) {
            userName = name; localStorage.setItem('wz_name', name);
            document.getElementById('name-screen').style.display = 'none';
            showMainMenu();
        }
    }

    function showMainMenu() { document.getElementById('main-menu').style.display = 'flex'; }

    function startNormal() {
        isArena = false;
        document.getElementById('main-menu').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        document.getElementById('helper-container').style.display = 'flex';
        document.getElementById('timer-neon').style.display = 'none';
        initRound(wordList[currentLvl % wordList.length]);
    }

    function openArena() {
        if(!navigator.onLine) { document.getElementById('offline-overlay').style.display='flex'; return; }
        document.getElementById('main-menu').style.display = 'none';
        document.getElementById('arena-lobby').style.display = 'flex';
    }

    function createRoom() {
        let code = Math.floor(1000 + Math.random() * 9000);
        document.getElementById('code-display').innerText = code;
        document.getElementById('lobby-controls').style.display = 'none';
        document.getElementById('room-active').style.display = 'block';
    }

    function joinRoom() {
        let code = document.getElementById('room-id-input').value;
        if(code.length === 4) {
            document.getElementById('code-display').innerText = code;
            document.getElementById('lobby-controls').style.display = 'none';
            document.getElementById('room-active').style.display = 'block';
            document.getElementById('room-status').innerText = "Odaya Girildi! (2/2)";
        }
    }

    function startArenaMatch() {
        isArena = true; arenaRound = 1;
        document.getElementById('arena-lobby').style.display = 'none';
        document.getElementById('game-screen').style.display = 'flex';
        document.getElementById('arena-scores').style.display = 'flex';
        document.getElementById('timer-neon').style.display = 'block';
        document.getElementById('helper-container').style.display = 'none';
        nextArenaWord();
    }

    function nextArenaWord() {
        if(arenaRound > 10) { alert("MAÃ‡ BÄ°TTÄ°! +6 JETON"); coins+=6; updateCoinUI(); location.reload(); return; }
        let rand = wordList[Math.floor(Math.random() * wordList.length)];
        initRound(rand);
        let sec = 60;
        document.getElementById('timer-neon').innerText = sec;
        clearInterval(timer);
        timer = setInterval(() => {
            sec--; document.getElementById('timer-neon').innerText = sec;
            if(sec <= 0) { arenaRound++; nextArenaWord(); }
        }, 1000);
    }

    function initRound(data) {
        const container = document.getElementById('word-container');
        container.innerHTML = ""; userGuess = [];
        document.getElementById('meaning-box').style.display = "none";
        document.getElementById('next-btn').style.display = "none";

        data.a.split('').forEach((char, i) => {
            const box = document.createElement('div');
            box.className = 'letter-box';
            if(data.h.includes(i)) {
                box.innerText = char; box.classList.add('correct-neon');
                userGuess[i] = char;
            } else { userGuess[i] = null; box.classList.add('active-box'); }
            container.appendChild(box);
        });
    }

    const input = document.getElementById('hidden-input');
    input.oninput = (e) => {
        let char = e.target.value.slice(-1).toUpperCase();
        if(char === 'Ä°' || char === 'I' || /[A-ZÃ‡ÄžÃ–ÅžÃœ]/.test(char)) {
            let emptyIdx = userGuess.indexOf(null);
            if(emptyIdx !== -1) {
                userGuess[emptyIdx] = char;
                document.getElementsByClassName('letter-box')[emptyIdx].innerText = char;
                document.getElementsByClassName('letter-box')[emptyIdx].classList.remove('active-box');
                let nextIdx = userGuess.indexOf(null);
                if(nextIdx !== -1) document.getElementsByClassName('letter-box')[nextIdx].classList.add('active-box');
                if(!userGuess.includes(null)) checkResult();
            }
        }
        e.target.value = "";
    };

    function checkResult() {
        let word = isArena ? document.getElementById('word-container').textContent : wordList[currentLvl % wordList.length].a;
        if(userGuess.join('') === word || (isArena && userGuess.join('').length > 0)) {
            if(!isArena) {
                coins += 25; updateCoinUI();
                document.getElementById('m-text').innerText = wordList[currentLvl % wordList.length].m;
                document.getElementById('meaning-box').style.display = "block";
                document.getElementById('next-btn').style.display = "block";
            } else {
                arenaRound++; setTimeout(nextArenaWord, 1000);
            }
        }
    }

    function getHint() {
        if(coins >= 10) {
            let empty = userGuess.indexOf(null);
            if(empty !== -1) {
                let correct = wordList[currentLvl % wordList.length].a[empty];
                userGuess[empty] = correct;
                document.getElementsByClassName('letter-box')[empty].innerText = correct;
                document.getElementsByClassName('letter-box')[empty].classList.add('correct-neon');
                coins -= 10; updateCoinUI();
            }
        }
    }

    function skipLevel() {
        if(coins >= 25) {
            coins -= 25; updateCoinUI();
            let data = wordList[currentLvl % wordList.length];
            userGuess = data.a.split('');
            initRound(data); // Harfleri doldurur
            document.getElementById('m-text').innerText = data.m;
            document.getElementById('meaning-box').style.display = "block";
            document.getElementById('next-btn').style.display = "block";
        }
    }

    function updateCoinUI() { document.getElementById('user-coins').innerText = coins; localStorage.setItem('wz_coins', coins); }
    function nextLevel() { currentLvl++; localStorage.setItem('wz_lvl', currentLvl); startNormal(); }
    function exitLobby() { location.reload(); }
    function focusInput() { input.focus(); }

    window.addEventListener('offline', () => { if(isArena) document.getElementById('offline-overlay').style.display='flex'; });
    window.addEventListener('online', () => document.getElementById('offline-overlay').style.display='none');
</script>
</body>
</html>
